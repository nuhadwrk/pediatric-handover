<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Pediatric Handover System</title>

  <!-- ‚îÄ‚îÄ‚îÄ Styles ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <style>
    body{font-family:sans-serif;margin:0;padding:24px;background:#f4f7fb}
    h1{margin:0 0 24px;text-align:center}
    .top-buttons{margin-bottom:24px;text-align:center}
    .top-buttons button{padding:10px 18px;margin:0 6px;font-weight:600;cursor:pointer}
    .form-section,.patient-card{background:#fff;padding:20px;border-radius:12px;box-shadow:0 4px 10px rgba(0,0,0,.05);margin-bottom:24px}
    .form-section input,.form-section select,.form-section textarea{width:100%;margin-bottom:12px;padding:8px}
    .card-grid{display:flex;flex-wrap:wrap;gap:18px}
    .patient-card{width:290px;position:relative}
    .delete-btn{position:absolute;top:8px;right:8px;background:#e74c3c;color:#fff;border:none;padding:4px 8px;cursor:pointer}
  </style>
</head>
<body>

  <h1>Pediatric Handover</h1>

  <!-- ‚îÄ‚îÄ‚îÄ Buttons ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <div class="top-buttons">
    <button onclick="document.getElementById('formSection').style.display='block'">‚ûï Add Patient</button>
    <button onclick="printHandover()">üñ®Ô∏è Print</button>
  </div>

  <!-- ‚îÄ‚îÄ‚îÄ Header (date etc.) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <div id="handoverHeader">
    <strong>Date:</strong> <span id="handoverDate"></span>
  </div>

  <!-- ‚îÄ‚îÄ‚îÄ Patient Form ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <div id="formSection" class="form-section" style="display:none;">
    <input id="name"        placeholder="Name"        required>
    <input id="id"          placeholder="ID"          required>
    <input id="bed"         placeholder="Bed"         required>
    <input id="age"         placeholder="Age"         required>
    <select id="sex">
      <option value="Male">Male</option>
      <option value="Female">Female</option>
    </select>
    <input id="diagnosis"   placeholder="Diagnosis">
    <input id="medications" placeholder="Medications">
    <select id="ward">
      <option value="PW">PW</option><option value="GW">GW</option><option value="SW">SW</option>
      <option value="PVT">PVT</option><option value="ICU">ICU</option><option value="NICU">NICU</option>
    </select>
    <textarea id="plan" placeholder="Plan"></textarea>
    <button onclick="addPatient()">Submit</button>
  </div>

  <!-- ‚îÄ‚îÄ‚îÄ Patient Cards ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <div id="wardsContainer">
    <div id="patientCards" class="card-grid"></div>
  </div>

  <!-- ‚îÄ‚îÄ‚îÄ Firebase SDKs (compat) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>

  <!-- ‚îÄ‚îÄ‚îÄ App Logic ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <script>
    /* ---------- 1. Firebase config ---------- */
    const firebaseConfig = {
      apiKey: "AIzaSyC3_DD-ezlWahQeCdPLcFh_lohLn63Q7eY",
      authDomain: "pediatric-handover.firebaseapp.com",
      projectId: "pediatric-handover",
      storageBucket: "pediatric-handover.appspot.com",
      messagingSenderId: "104007714087",
      appId: "1:104007714087:web:77811513530b0ee9859502"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    /* ---------- 2. Helpers ---------- */
    document.getElementById('handoverDate').textContent =
      new Date().toISOString().split('T')[0];

    function clearForm() {
      ['name','id','bed','age','diagnosis','medications','plan'].forEach(id => 
        document.getElementById(id).value = '');
      document.getElementById('sex').value  = 'Male';
      document.getElementById('ward').value = 'PW';
    }

    /* ---------- 3. Add patient ---------- */
    function addPatient() {
      const patient = {
        name:        name.value.trim(),
        id:          id.value.trim(),
        bed:         bed.value.trim(),
        age:         age.value.trim(),
        sex:         sex.value,
        diagnosis:   diagnosis.value.trim(),
        medications: medications.value.trim(),
        ward:        ward.value,
        plan:        plan.value.trim(),
        ts:          Date.now()
      };
      if(!patient.name) return alert('Name is required');

      db.collection('patients').add(patient)
        .then(() => {
          document.getElementById('formSection').style.display='none';
          clearForm();
          loadPatients(); // refresh list
        })
        .catch(err => {
          console.error('Firestore add error:', err);
          alert('Could not save ‚Äì see console');
        });
    }

    /* ---------- 4. Load patients ---------- */
    function loadPatients() {
      const wrap = document.getElementById('patientCards');
      wrap.innerHTML = '';
      db.collection('patients').orderBy('ts','desc').get()
        .then(qs => {
          qs.forEach(doc => {
            const d = doc.data();
            const card = document.createElement('div');
            card.className = 'patient-card';
            card.innerHTML = `
              <button class="delete-btn" onclick="delPatient('${doc.id}')">‚úï</button>
              <p><strong>${d.name}</strong> (ID: ${d.id})</p>
              <p>Bed ${d.bed} ‚Ä¢ ${d.age}y ‚Ä¢ ${d.sex}</p>
              <p><em>${d.diagnosis}</em></p>
              <p>${d.medications}</p>
              <p>${d.plan}</p>
              <p><small>Ward: ${d.ward}</small></p>`;
            wrap.appendChild(card);
          });
        })
        .catch(err => console.error('Load error:', err));
    }

    /* ---------- 5. Delete patient ---------- */
    function delPatient(id) {
      db.collection('patients').doc(id).delete()
        .then(loadPatients);
    }

    /* ---------- 6. Print ---------- */
    function printHandover() { window.print(); }

    /* ---------- 7. Initial load ---------- */
    loadPatients();
  </script>
</body>
</html>
