<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Pediatric Handover System</title>

  <!-- ‚îÄ‚îÄ‚îÄ Inter Font ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- ‚îÄ‚îÄ‚îÄ Styles ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <style>
    :root{
      --bg:#f4f7fb;--primary:#0066cc;--primary-dark:#004a99;
      --accent:#2a9d8f;--card-bg:#fff;--text:#1d3557;
      --shadow:0 4px 12px rgba(0,0,0,.08)
    }
    *{box-sizing:border-box}body{
      font-family:'Inter',sans-serif;background:var(--bg);
      color:var(--text);margin:0;padding:24px;
    }
    h1{font-weight:700;margin:0 0 20px;text-align:center}
    /* top buttons */
    .top-buttons{text-align:center;margin:12px 0 32px}
    .top-buttons button{
      margin:6px;padding:10px 20px;font-weight:600;
      border:none;border-radius:8px;cursor:pointer;
      transition:background .2s,transform .2s
    }
    .top-buttons button:hover{transform:translateY(-2px)}
    .add-btn{background:var(--primary);color:#fff}
    .add-btn:hover{background:var(--primary-dark)}
    .print-btn{background:var(--accent);color:#fff}
    .print-btn:hover{background:#1f7b72}

    /* form */
    .form-section{
      display:none;background:var(--card-bg);padding:24px 28px;
      border-radius:12px;max-width:520px;margin:0 auto 40px;
      box-shadow:var(--shadow)
    }
    label{font-weight:600;display:block;margin-top:14px}
    input,select,textarea{
      width:100%;margin-top:6px;margin-bottom:10px;padding:10px 12px;
      border-radius:8px;border:1px solid #ccc;font-size:14px
    }
    textarea{resize:vertical}.inline-group{display:flex;gap:12px}
    .inline-group>div{flex:1}
    button[type=submit]{width:100%;margin-top:18px;padding:12px;
      background:var(--primary);color:#fff;border:none;border-radius:6px;cursor:pointer;font-weight:600}

    /* cards & grid */
    .card-grid{display:flex;flex-wrap:wrap;gap:18px;justify-content:center}
    .patient-card{
      background:var(--card-bg);width:300px;padding:18px 16px;
      border-radius:12px;box-shadow:var(--shadow);position:relative;
      transition:transform .18s ease
    }
    .patient-card:hover{transform:scale(1.015)}
    .patient-card h3{margin:0 0 8px;font-size:18px;color:var(--primary-dark)}
    .patient-card p{margin:4px 0}
    .delete-btn{
      position:absolute;top:10px;right:10px;background:#e63946;
      color:#fff;border:none;border-radius:4px;padding:4px 8px;cursor:pointer;font-size:12px
    }
    .delete-btn:hover{opacity:.85}

    @media(max-width:768px){
      .card-grid{flex-direction:column;align-items:center}
      .patient-card{width:90%}.inline-group{flex-direction:column}
    }
  </style>
</head>
<body>
  <h1>Pediatric Handover</h1>

  <!-- Top Buttons -->
  <div class="top-buttons">
    <button class="add-btn" onclick="toggleForm()">‚ûï Add Patient</button>
    <button class="print-btn" onclick="printHandover()">üñ®Ô∏è Print</button>
  </div>

  <!-- Date header -->
  <div id="handoverHeader" style="text-align:center;margin-bottom:32px">
    <strong>Date:</strong> <span id="handoverDate"></span>
  </div>

  <!-- Patient Form -->
  <div id="formSection" class="form-section">
    <form id="patientForm">
      <label>Name</label>
      <input id="name" required>
      <label>ID</label>
      <input id="pid" required>
      <label>Bed</label>
      <input id="bed" required>
      <div class="inline-group">
        <div>
          <label>Age</label>
          <input id="age" required>
        </div>
        <div>
          <label>Sex</label>
          <select id="sex"><option value="Male">Male</option><option value="Female">Female</option></select>
        </div>
      </div>
      <label>Diagnosis</label>
      <input id="diagnosis">
      <label>Medications</label>
      <input id="medications">
      <label>Ward</label>
      <select id="ward">
        <option>PW</option><option>GW</option><option>SW</option><option>PVT</option><option>ICU</option><option>NICU</option>
      </select>
      <label>Plan</label>
      <textarea id="plan" rows="3"></textarea>
      <button type="submit">Submit</button>
    </form>
  </div>

  <!-- Patient Cards -->
  <div class="card-grid" id="cards"></div>

  <!-- Firebase SDK (compat) -->
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>

  <script>
    /* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Firebase Config ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
    firebase.initializeApp({
      apiKey: "AIzaSyC3_DD-ezlWahQeCdPLcFh_lohLn63Q7eY",
      authDomain: "pediatric-handover.firebaseapp.com",
      projectId: "pediatric-handover",
      storageBucket: "pediatric-handover.appspot.com",
      messagingSenderId: "104007714087",
      appId: "1:104007714087:web:77811513530b0ee9859502"
    });
    const db = firebase.firestore();

    /* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Utility ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
    const $ = id => document.getElementById(id);
    $('handoverDate').textContent = new Date().toISOString().split('T')[0];

    function toggleForm() {
      const f = $('formSection');
      f.style.display = f.style.display==='block' ? 'none' : 'block';
    }

    function clearForm() {
      ['name','pid','bed','age','diagnosis','medications','plan']
        .forEach(id=>$(id).value='');
      $('sex').value = 'Male'; $('ward').value='PW';
    }

    /* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Add Patient ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
    $('patientForm').addEventListener('submit', e=>{
      e.preventDefault();
      const p = {
        name: $('name').value.trim(),
        id:   $('pid').value.trim(),
        bed:  $('bed').value.trim(),
        age:  $('age').value.trim(),
        sex:  $('sex').value,
        diagnosis: $('diagnosis').value.trim(),
        medications:$('medications').value.trim(),
        ward: $('ward').value,
        plan: $('plan').value.trim(),
        ts: Date.now()
      };
      if(!p.name) return alert('Name required');
      db.collection('patients').add(p)
        .then(()=>{ toggleForm(); clearForm(); loadPatients(); })
        .catch(err=>{console.error(err); alert('Save failed');});
    });

    /* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Delete ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
    function del(id){ db.collection('patients').doc(id).delete().then(loadPatients); }

    /* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Load & Render ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
    function loadPatients(){
      const wrap=$('cards');wrap.innerHTML='';
      db.collection('patients').orderBy('ts','desc').get().then(q=>{
        q.forEach(doc=>{
          const d=doc.data();
          const card=document.createElement('div');card.className='patient-card';
          card.innerHTML=`
            <button class="delete-btn" onclick="del('${doc.id}')">‚úï</button>
            <h3>${d.name} (ID:${d.id})</h3>
            <p><strong>Bed:</strong> ${d.bed}</p>
            <p>Age ${d.age} ‚Ä¢ ${d.sex}</p>
            <p><em>${d.diagnosis||''}</em></p>
            <p>${d.medications||''}</p>
            <p>${d.plan||''}</p>
            <p><small>Ward: ${d.ward}</small></p>`;
          wrap.appendChild(card);
        });
      });
    }

    /* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Print ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
    function printHandover(){window.print();}

    loadPatients(); // initial
  </script>
</body>
</html>
